!function(n){"use strict";function r(n){var r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var t in r)if(void 0!==n.style[t])return r[t]}function t(){var n={},r=null,t={style:"fill",direction:"horizontal",randomProgress:!0};this.profile=function(t,e){if(1===arguments.length){if(r)throw Error("Default profile already set.");r=t}else{if(n[t])throw Error("Profile ["+t+"] aready set.");n[t]=e}},this.$get=function(){return{getProfile:function(e){return e&&n[e]?n[e]:r||t}}}}function e(t,e,s){return{restrict:"A",transclude:!0,scope:{pbStyle:"@",pbDirection:"@",pbProfile:"@",ngProgressButton:"="},template:'<span class="content" ng-transclude></span><span class="progress"><span class="progress-inner" ng-style="progressStyles" ng-class="{ notransition: !allowProgressTransition }"></span></span>',controller:function(){},link:function(o,i,a){function l(n){o.progressStyles[g]=100*n+"%"}function p(){var n=0;return s(function(){n+=(1-n)*Math.random()*.5,l(n)},200)}function c(){o.$apply(function(){o.disabled=!1})}function d(n){function r(n){("opacity"===n.propertyName||n.originalEvent&&"opacity"===n.originalEvent.propertyName)&&(i.off(f,r),o.$apply(function(){o.allowProgressTransition=!1,l(0),o.progressStyles.opacity=1}))}if(f&&(o.progressStyles.opacity=0,i.on(f,r)),"number"==typeof n){var t=n>=0?"state-success":"state-error";i.addClass(t),setTimeout(function(){i.removeClass(t),c()},1500)}else c();i.removeClass("state-loading")}!function(){var n=e.getProfile(o.pbProfile);o.pbStyle=o.pbStyle||n.style||"fill","lateral-lines"!==o.pbStyle?o.pbDirection=o.pbDirection||n.direction||"horizontal":o.pbDirection="vertical",o.pbPerspective=0===o.pbStyle.indexOf("rotate")||0===o.pbStyle.indexOf("flip-open"),o.pbRandomProgress=a.pbRandomProgress?"false"!==a.pbRandomProgress:n.randomProgress||!0}();var f=r(i[0]),g="vertical"===o.pbDirection?"height":"width";if(o.pbPerspective){var u=n.element('<span class="progress-wrap"></span>');u.append(i.children()),i.append(u),i.addClass("progress-button-perspective")}o.progressStyles={},o.disabled=!1,o.allowProgressTransition=!1,i.addClass("progress-button"),i.addClass("progress-button-dir-"+o.pbDirection),i.addClass("progress-button-style-"+o.pbStyle),o.$watch("disabled",function(n){i.toggleClass("disabled",n)}),o.$watch("ngProgressButton",function(n,r){if(n!==r){if(o.disabled)return;o.disabled=!0,i.addClass("state-loading"),o.allowProgressTransition=!0;var e=null;t.when(n).then(function(){l(1),e&&s.cancel(e),d(1)},function(){e&&s.cancel(e),d(-1)},function(n){o.pbRandomProgress||l(n)}),o.pbRandomProgress&&(e=p())}})}}}var s=n.module("ngProgressButtonStyles",[]);s.provider("ngProgressButtonConfig",t),s.directive("ngProgressButton",e),e.$inject=["$q","ngProgressButtonConfig","$interval"]}(angular);